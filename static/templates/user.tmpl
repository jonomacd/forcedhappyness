{{define "body"}}
{{$IsUser :=  .HasSession | and (eq .SessionUser.ID  .User.ID) }}

        
<div class="fh-feed mdl-layout mdl-js-layout has-drawer is-upgraded">
    <main class="mdl-layout__content">    
        <div class="user-card">
            <div class="user-avatar">
                <img src="{{.User.AvatarUrl}}" height="210" width="210" onerror="this.src='/static/img/unknown-user.png'"/>
            </div>
            <div class="name-details">
                <h4>{{.User.NameTitle}}</h4>
                {{.User.Details}}
            </div>
            {{if .HasSession | and (not $IsUser)}}
                <div class="follow-button">
                    <button id='follow-button' onclick='toggleFollow({{.User.ID}})'class="follow-button mdl-cell--middle mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect">
                        {{if .Follows}}Unfollow{{else}}Follow{{end}}
                    </button>
                </div>
            {{end}}
        </div>        

        {{block "posts" .}}
            Whoops looks like you have landed somewhere strange
        {{end}}
    </main>
</div>
    

{{if .HasSession | and (not $IsUser)}}
<script>
    function toggleFollow(userID){
        fetch('/follow', {
            method: 'post',
            credentials: 'include',
            headers: {
            "Content-type": "application/json; charset=UTF-8"
            },
            body: JSON.stringify({
                userID: userID,
            })
        })
        .then(function (response) {
            if (response.status == 200) {
                response.json().then(function(data) {
                    var aa = document.getElementById('follow-button');                                        
                    if (data.follows) {
                        aa.innerText = "Unfollow";                        
                    }else {
                        aa.innerText = "Follow";
                    }
                });                            
            }
        })
        .catch(function (error) {
            var snackbarContainer = document.querySelector('#error-snackbar');
            var data = {message: 'Error Updating Follow'};
            snackbarContainer.MaterialSnackbar.showSnackbar(data);
        });
        return false
    }
</script>
{{end}}


{{end}}